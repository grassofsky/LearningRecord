# OSG - 场景的组织结构

> 《OpenSceneGraph三维渲染引擎设计与实践》 - 阅读笔记



>  采用包围体层次的场景图通常采用树状结构来保存信息。一棵场景树包括一个根节点、多级内部的枝节点，以及多个末端的叶子节点。根节点和枝节点负责构建树的层次，已完成某些特定的功能；而叶子点则保存了某一个或多个可绘制对象的信息。

> 叶子节点的工作就是保存和管理一个或多个可绘制物体的信息，这些可绘制形体的容纳者称为Drawable类；



> 节点功能分类：
>
> 1. 空间变换节点；影响子节点的空间位置变化；
> 2. 开关节点；控制子节点的隐藏显示；
> 3. 细节层次节点；Level of Detail
> 4. 相机节点；
> 5. 投影节点Projection；不需要考虑投影节点自身的位置和姿态变化；
> 6. 渲染属性节点StateSet；是表达真实场景的不可或缺的要素，光照、雾效果、透明度效果、纹理贴图等。OSG采用了为每个节点设置StateSet的方式来管理渲染属性，而不是派生自Group类的功能节点，而父节点的渲染属性同样可以有选择地继承到子节点之上。
> 7. 覆盖节点（overlay）。子节点渲染结果覆盖到另一个场景的指定对象上，从而实现更丰富的节点功能。
> 8. 遮挡裁剪节点。判断某种形状的物体是否挡住了其他场景中的对象，因而不再重新绘制哪些被遮挡的对象的裁剪方法。OccluderNode。
> 9. 动态调度节点。对于大规模场景，当将大量的模型读入内存时，必然会造成计算机系统的巨大负担，并且可能因为内存不足而造成程序出错，甚至系统奔溃。动态调度节点，当它某些子节点对场景绘制长期没有助益时，可以将子节点自动卸载，释放内存空间；反之，也可以及时加载某些不再内存中的子节点。
> 10. 关节节点。一种受限制的空间变换节点。从属与osgAnimation库的Bone类和Skeleton完成了关节节点的功能。
> 11. 代理节点。作为另一种尚未加载的节点的代理者而存在，被代理的对象（可能是很复杂的一个模型）会在适当的时候被加载到内存中；在此之前，代理者起到占位和节省系统启动时间的作用。如，ProxyNode。

**TODO：节点访问示例**



> OSG节点回调包括更新回调（Update Callback，每一帧系统遍历到当前节点的时候都会被自动调用）和人机交互事件回调（Event Callback，由用户交互时间触发，如键盘、鼠标、改变窗口大小等）两种。

**TODO: 回调函数示例**

