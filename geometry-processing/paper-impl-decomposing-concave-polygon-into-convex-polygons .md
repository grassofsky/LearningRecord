# PaperImpl - 邻近凹点角平分线的多边形顶点快速凸分算法研究及应用

原文地址：http://nldxb.njfu.edu.cn/oa/darticle.aspx?id=201305032

**判断多变形的走向**：可以借助多边形面积的符号进行判断，<0，多边形为顺时针，>0，多边形为逆时针，多边形面积计算可以参见：https://www.cnblogs.com/TenosDoIt/p/4047211.html；

**顶点凸凹性判断**：顶点的入边向量和出边向量的叉乘，<0，则点为凹点，>0，则该点为凸点；

**算法过程简单描述**：

1）利用**顶点凸凹性判断**找出凹点，然后对该凹点做角平分线，假设该点为$p_i$，前一个点为$p_{i-1}$，后一个点为$p_{i+1}$，那么可以计算得到角平分线的法向量：
$$
\vec{n} = normalize(normalize(p_{i} - p_{i-1}) + normalize(p_{i+1} - p_{i}))
$$
$normalize$表示对向量进行归一化。接着利用原点到$p_i$点的向量求出原点到直线的距离，如下：
$$
d = \vec{op_i} \cdot \vec{n}
$$
此时，可以得到角平分线的隐式方程（关于直线隐式方程的介绍可以参见：[BookRead - 《3D数学基础 ：图形与游戏开发》 读后小结](https://www.cnblogs.com/grass-and-moon/p/13598114.html)），如下：
$$
\vec{op} \cdot \vec{n} = d
$$
其中$\vec{op}$表示，原点到直线上的任一点p构成的向量。

2）寻找凹点的可视点。可视点是除凹点及前后相邻顶点外的多边形其他顶点，且凹点与可视点的连接线段与多边形没有其他的交点。方法很简单。获取多边形除凹点，凹点前后的点，待测点，待测点前后的点之外的所有的点到垂直平分线的有向距离，如果有相邻两个点的有向距离符号相反，或者某个点的有向距离为0，那么该待测点不是可视点；其中求一个点到角平分线的有向距离公式为：
$$
d' = \vec{oq} \cdot \vec{n} - d
$$
3）找到可视点中绝对距离最近的点为划分点，利用该划分点，将凹多边形划分为两个多边形；

4）判断划分后的多边形的凹凸性；如果是凹多边形进入下一步；否则停止；

5）递归循环。循环1）-4）步骤，直到全部多边形为凸多边形。

